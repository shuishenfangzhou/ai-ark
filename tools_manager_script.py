# -*- coding: utf-8 -*-
"""Tools Manager Script

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1vCGSncfjVnrrEATdYekmJUOrlh4KCmn-
"""

import os
import urllib.request
import json
import ssl

# å¿½ç•¥ SSL è¯ä¹¦éªŒè¯ï¼ˆé˜²æ­¢ä¸‹è½½å›¾ç‰‡æŠ¥é”™ï¼‰
ssl._create_default_https_context = ssl._create_unverified_context

# 1. çœŸå® AI å·¥å…·æ•°æ®åº“ (åŒ…å«å®˜ç½‘å’Œ Logo é“¾æ¥)
# æ³¨æ„ï¼šå®é™…è¿è¡Œæ—¶éƒ¨åˆ† Logo é“¾æ¥å¯èƒ½ä¼šå¤±æ•ˆï¼Œè„šæœ¬ä¼šè‡ªåŠ¨å¤„ç†
tools_db = [
    # --- å›½äº§çƒ­é—¨ ---
    {
        "id": "cn-001", "name": "DeepSeek", "category": "text",
        "desc": "æ·±åº¦æ±‚ç´¢å¼€å‘çš„å›½äº§å¼€æºå¤§æ¨¡å‹ï¼Œæ¨ç†èƒ½åŠ›æƒŠäººã€‚",
        "url": "https://www.deepseek.com/",
        "logo_url": "https://pbs.twimg.com/profile_images/1780076211750699008/7o_eQeg2_400x400.jpg",
        "tags": ["å›½äº§ä¹‹å…‰", "å¼€æº", "å…è´¹"]
    },
    {
        "id": "cn-002", "name": "Kimiæ™ºèƒ½åŠ©æ‰‹", "category": "text",
        "desc": "æœˆä¹‹æš—é¢ç§‘æŠ€æ¨å‡ºçš„è¶…é•¿æ–‡æœ¬å¤„ç† AIï¼Œæ”¯æŒ 20 ä¸‡å­—ä¸Šä¸‹æ–‡ã€‚",
        "url": "https://kimi.moonshot.cn/",
        "logo_url": "https://img.qcog.cn/submission/2024/23018285/c10e147f8774e12e75344386926943c7.png",
        "tags": ["é•¿æ–‡æœ¬", "æ–‡ä»¶åˆ†æ", "å…è´¹"]
    },
    {
        "id": "cn-003", "name": "è±†åŒ…", "category": "text",
        "desc": "å­—èŠ‚è·³åŠ¨å‡ºå“çš„ AI å¯¹è¯åŠ©æ‰‹ï¼Œè¯­éŸ³äº¤äº’ä½“éªŒæä½³ã€‚",
        "url": "https://www.doubao.com/",
        "logo_url": "https://lf-flow-web-cdn.doubao.com/obj/flow-web-cdn/doubao/web/logo-icon.png",
        "tags": ["å­—èŠ‚è·³åŠ¨", "è¯­éŸ³", "å…è´¹"]
    },
    {
        "id": "cn-004", "name": "é€šä¹‰åƒé—®", "category": "text",
        "desc": "é˜¿é‡Œå·´å·´ç ”å‘çš„è¶…å¤§è§„æ¨¡è¯­è¨€æ¨¡å‹ï¼Œå…¨èƒ½å‹åŠ©æ‰‹ã€‚",
        "url": "https://tongyi.aliyun.com/",
        "logo_url": "https://img.alicdn.com/imgextra/i4/O1CN016y5q5H1uH7H8u5H5H_!!6000000006013-2-tps-200-200.png",
        "tags": ["é˜¿é‡Œ", "å…¨èƒ½", "å…è´¹"]
    },
    {
        "id": "cn-005", "name": "å³æ¢¦AI", "category": "image",
        "desc": "å­—èŠ‚è·³åŠ¨æ¨å‡ºçš„ AI ç»˜ç”»ä¸è§†é¢‘ç”Ÿæˆå·¥å…·ï¼Œæ•ˆæœæƒŠè‰³ã€‚",
        "url": "https://jimeng.jianying.com/",
        "logo_url": "https://p3-pc-sign.douyinpic.com/tos-cn-i-0813c001/oAABqC6A9AAg9AAg9AAg9AAg9.png?x-expires=1740000000&x-signature=image_logo",
        "tags": ["ç»˜ç”»", "è§†é¢‘", "å­—èŠ‚"]
    },
    {
        "id": "cn-006", "name": "ç§˜å¡”AIæœç´¢", "category": "search",
        "desc": "æ²¡æœ‰å¹¿å‘Šçš„ AI æœç´¢å¼•æ“ï¼Œç²¾å‡†æ£€ç´¢å¹¶ç”Ÿæˆæ‘˜è¦ã€‚",
        "url": "https://metaso.cn/",
        "logo_url": "https://metaso.cn/favicon.ico",
        "tags": ["æœç´¢", "æ— å¹¿å‘Š", "å­¦æœ¯"]
    },

    # --- å›½é™…é¡¶æµ ---
    {
        "id": "us-001", "name": "ChatGPT", "category": "text",
        "desc": "OpenAI å¼€å¯ AI æ—¶ä»£çš„é‡Œç¨‹ç¢‘äº§å“ï¼ŒGPT-4o æå…¶å¼ºå¤§ã€‚",
        "url": "https://chat.openai.com/",
        "logo_url": "https://upload.wikimedia.org/wikipedia/commons/thumb/0/04/ChatGPT_logo.svg/1024px-ChatGPT_logo.svg.png",
        "tags": ["OpenAI", "æœ€å¼º", "ä»˜è´¹/å…è´¹"]
    },
    {
        "id": "us-002", "name": "Midjourney", "category": "image",
        "desc": "ç›®å‰å…¬è®¤ç”Ÿæˆè´¨é‡æœ€é«˜çš„ AI ç»˜ç”»å·¥å…·ï¼Œè‰ºæœ¯æ„Ÿæå¼ºã€‚",
        "url": "https://www.midjourney.com/",
        "logo_url": "https://upload.wikimedia.org/wikipedia/commons/e/ed/Midjourney_Emblem.png",
        "tags": ["ç»˜ç”»", "è‰ºæœ¯", "ä»˜è´¹"]
    },
    {
        "id": "us-003", "name": "Claude 3", "category": "text",
        "desc": "Anthropic å‡ºå“ï¼Œé€»è¾‘æ¨ç†ä¸ä»£ç èƒ½åŠ›è¶…è¶Š GPT-4 çš„å¼ºåŠ›æ¨¡å‹ã€‚",
        "url": "https://claude.ai/",
        "logo_url": "https://upload.wikimedia.org/wikipedia/commons/thumb/7/74/Claude_AI_logo.png/600px-Claude_AI_logo.png",
        "tags": ["é€»è¾‘å¼º", "æ‹ŸäººåŒ–", "å…è´¹"]
    },
    {
        "id": "us-004", "name": "Sora", "category": "video",
        "desc": "OpenAI å‘å¸ƒçš„æ–‡ç”Ÿè§†é¢‘æ¨¡å‹ï¼Œè™½ç„¶æœªå…¬æµ‹ä½†å·²éœ‡æ’¼ä¸–ç•Œã€‚",
        "url": "https://openai.com/sora",
        "logo_url": "https://upload.wikimedia.org/wikipedia/commons/thumb/4/4d/OpenAI_Logo.svg/1024px-OpenAI_Logo.svg.png",
        "tags": ["è§†é¢‘", "æœªå‘å¸ƒ", "OpenAI"]
    },
    {
        "id": "us-005", "name": "Suno", "category": "audio",
        "desc": "æ–‡å­—ä¸€é”®ç”Ÿæˆ 3 åˆ†é’Ÿå¹¿æ’­çº§æ­Œæ›²ï¼ŒéŸ³ä¹ç•Œçš„ ChatGPTã€‚",
        "url": "https://suno.com/",
        "logo_url": "https://yt3.googleusercontent.com/Vi9O6rI6CqA8YgV4y1y4y1y4=s900-c-k-c0x00ffffff-no-rj",
        "tags": ["éŸ³ä¹", "åˆ›ä½œ", "çƒ­é—¨"]
    },
    {
        "id": "us-006", "name": "Stable Diffusion", "category": "image",
        "desc": "å¼€æº AI ç»˜ç”»çš„åŸºçŸ³ï¼Œæ”¯æŒæœ¬åœ°éƒ¨ç½²ï¼Œå¯æ§æ€§æœ€é«˜ã€‚",
        "url": "https://stability.ai/",
        "logo_url": "https://stability.ai/images/stability-ai-logo.png",
        "tags": ["å¼€æº", "æœ¬åœ°", "ç»˜ç”»"]
    },
     {
        "id": "dev-001", "name": "GitHub Copilot", "category": "code",
        "desc": "AI ç¼–ç¨‹åŠ©æ‰‹ï¼Œç›´æ¥åœ¨ç¼–è¾‘å™¨ä¸­è‡ªåŠ¨è¡¥å…¨ä»£ç ã€‚",
        "url": "https://github.com/features/copilot",
        "logo_url": "https://upload.wikimedia.org/wikipedia/commons/thumb/2/2a/GitHub_mark_wrapper.svg/512px-GitHub_mark_wrapper.svg.png",
        "tags": ["ç¼–ç¨‹", "å¾®è½¯", "ä»˜è´¹"]
    },
    {
        "id": "dev-002", "name": "Trae", "category": "code",
        "desc": "å­—èŠ‚è·³åŠ¨æ¨å‡ºçš„è‡ªé€‚åº” AI IDEï¼Œä½ çš„æ™ºèƒ½ç¼–ç¨‹æ­æ¡£ã€‚",
        "url": "https://www.trae.ai/",
        "logo_url": "https://lf-flow-web-cdn.doubao.com/obj/flow-web-cdn/doubao/web/logo-icon.png", # æš‚ç”¨è±†åŒ…logoæ›¿ä»£
        "tags": ["ç¼–ç¨‹", "IDE", "å…è´¹"]
    }
]

# 2. é…ç½®è·¯å¾„
ASSETS_DIR = "assets/logos"
JS_FILE_PATH = "js/tools_data.js"

def setup_directories():
    if not os.path.exists(ASSETS_DIR):
        os.makedirs(ASSETS_DIR)
        print(f"âœ… åˆ›å»ºç›®å½•: {ASSETS_DIR}")

    js_dir = os.path.dirname(JS_FILE_PATH)
    if not os.path.exists(js_dir):
        os.makedirs(js_dir)
        print(f"âœ… åˆ›å»ºç›®å½•: {js_dir}")

def download_logo(url, name):
    # æ¸…ç†æ–‡ä»¶å
    safe_name = "".join([c for c in name if c.isalnum() or c in ('-','_')]).lower()
    file_path = f"{ASSETS_DIR}/{safe_name}.png"

    # å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œè·³è¿‡
    if os.path.exists(file_path):
        return file_path

    try:
        # ä¼ªè£… User-Agent é˜²æ­¢è¢«æ‹¦æˆª
        req = urllib.request.Request(
            url,
            data=None,
            headers={'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'}
        )
        with urllib.request.urlopen(req, timeout=10) as response, open(file_path, 'wb') as out_file:
            out_file.write(response.read())
        print(f"ğŸ“¥ ä¸‹è½½æˆåŠŸ: {name}")
        return file_path
    except Exception as e:
        print(f"âš ï¸ ä¸‹è½½å¤±è´¥ [{name}]: {e}")
        return None

def main():
    setup_directories()

    final_data = []

    print("ğŸš€ å¼€å§‹æ›´æ–° AI å·¥å…·åº“...")

    for tool in tools_db:
        # ä¸‹è½½å›¾ç‰‡
        local_path = download_logo(tool["logo_url"], tool["name"])

        # æ›´æ–°å·¥å…·æ•°æ®ä¸­çš„ image å­—æ®µ
        tool_entry = tool.copy()
        if local_path:
            tool_entry["logo"] = local_path
        else:
            tool_entry["logo"] = "assets/logos/default.png" # éœ€å‡†å¤‡ä¸€ä¸ªé»˜è®¤å›¾

        # ç§»é™¤è¿œç¨‹ url å­—æ®µï¼Œåªä¿ç•™æœ¬åœ° path (æˆ–è€…ä¸¤ä¸ªéƒ½ç•™)
        del tool_entry["logo_url"]

        final_data.append(tool_entry)

    # ç”Ÿæˆ JS æ–‡ä»¶
    js_content = f"// Auto-generated by tools_manager.py\nconst aiToolsData = {json.dumps(final_data, indent=4, ensure_ascii=False)};"

    with open(JS_FILE_PATH, "w", encoding="utf-8") as f:
        f.write(js_content)

    print(f"\nâœ¨ å®Œæˆ! æ•°æ®å·²å†™å…¥ {JS_FILE_PATH}")
    print(f"ğŸ“Š å…±æ”¶å½• {len(final_data)} ä¸ªå·¥å…·")

if __name__ == "__main__":
    main()